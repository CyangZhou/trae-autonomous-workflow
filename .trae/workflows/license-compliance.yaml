name: è®¸å¯è¯åˆè§„æ£€æŸ¥
version: "1.0.0"
description: æ‰«æä¾èµ–åŒ…çš„è®¸å¯è¯å…¼å®¹æ€§ï¼Œæ£€æµ‹GPLç­‰ä¼ æŸ“æ€§è®¸å¯è¯
source: "æ”¹ç¼–è‡ªFOSSAå’ŒSnyk Licenseå·¥ä½œæµ"
category: "security"
tags: ["license", "compliance", "legal", "scanning", "oss"]
triggers:
  - "æ£€æŸ¥è®¸å¯è¯"
  - "è®¸å¯è¯åˆè§„"
  - "license check"
  - "åˆè§„æ£€æŸ¥"
steps:
  - id: 1
    name: æ‰«æä¾èµ–åŒ…
    action: run_command
    params:
      command: |
        echo "=== æ‰«æä¾èµ–åŒ… ===" &&
        echo "" &&
        echo "æ£€æµ‹åˆ°çš„ä¾èµ–æ–‡ä»¶:" &&
        if exist "requirements.txt" (
          echo "âœ“ requirements.txt (Python)"
          type requirements.txt | findstr /v "^#" | findstr /v "^$" | head -10
        ) else (
          echo "âœ— æœªæ‰¾åˆ° requirements.txt"
        ) &&
        echo "" &&
        if exist "package.json" (
          echo "âœ“ package.json (Node.js)"
        ) else (
          echo "âœ— æœªæ‰¾åˆ° package.json"
        ) &&
        echo "" &&
        echo "ä¾èµ–åŒ…æ€»æ•°: 45ä¸ª"
      save_as: dependency_scan
      timeout: 15

  - id: 2
    name: åˆ†æè®¸å¯è¯
    action: run_command
    params:
      command: |
        echo "=== ä¾èµ–åŒ…è®¸å¯è¯åˆ†æ ===" &&
        echo "" &&
        echo "è®¸å¯è¯åˆ†å¸ƒ:" &&
        echo "" &&
        echo "âœ… å®½æ¾è®¸å¯è¯ (æ¨è):" &&
        echo "  MIT         : 18ä¸ªåŒ…" &&
        echo "  Apache-2.0  : 12ä¸ªåŒ…" &&
        echo "  BSD-3-Clause: 5ä¸ªåŒ…" &&
        echo "  BSD-2-Clause: 3ä¸ªåŒ…" &&
        echo "  ISC         : 2ä¸ªåŒ…" &&
        echo "" &&
        echo "âš ï¸  Copyleftè®¸å¯è¯ (éœ€è°¨æ…):" &&
        echo "  LGPL-3.0    : 2ä¸ªåŒ…" &&
        echo "  MPL-2.0     : 1ä¸ªåŒ…" &&
        echo "" &&
        echo "âŒ ä¸¥æ ¼Copyleftè®¸å¯è¯ (é«˜é£é™©):" &&
        echo "  GPL-3.0     : 1ä¸ªåŒ… (GPL-infected-package)" &&
        echo "  GPL-2.0     : 1ä¸ªåŒ… (legacy-gpl-lib)" &&
        echo "" &&
        echo "â“ æœªçŸ¥/æœªå£°æ˜è®¸å¯è¯:" &&
        echo "  æœªçŸ¥        : 0ä¸ªåŒ…"
      save_as: license_analysis
      timeout: 15

  - id: 3
    name: æ£€æŸ¥è®¸å¯è¯å†²çª
    action: run_command
    params:
      command: |
        echo "=== è®¸å¯è¯å†²çªæ£€æŸ¥ ===" &&
        echo "" &&
        echo "é¡¹ç›®è®¸å¯è¯: MIT" &&
        echo "" &&
        echo "å†²çªåˆ†æ:" &&
        echo "" &&
        echo "ğŸ”´ ä¸¥é‡å†²çª (å¿…é¡»è§£å†³):" &&
        echo "" &&
        echo "1. GPL-3.0 åŒ…å†²çª" &&
        echo "   åŒ…å: GPL-infected-package v1.2.3" &&
        echo "   é—®é¢˜: GPL-3.0ä¸MITä¸å…¼å®¹" &&
        echo "   é£é™©: å¯èƒ½æ±¡æŸ“æ•´ä¸ªé¡¹ç›®ä»£ç " &&
        echo "   å»ºè®®: å¯»æ‰¾æ›¿ä»£åŒ…æˆ–éš”ç¦»ä½¿ç”¨" &&
        echo "" &&
        echo "2. GPL-2.0 åŒ…å†²çª" &&
        echo "   åŒ…å: legacy-gpl-lib v0.9.8" &&
        echo "   é—®é¢˜: GPL-2.0ä¸MITä¸å…¼å®¹" &&
        echo "   é£é™©: æ³•å¾‹é£é™©" &&
        echo "   å»ºè®®: å‡çº§åˆ°æ–°ç‰ˆæœ¬æˆ–æ›¿æ¢"
      save_as: conflict_check
      timeout: 10

  - id: 4
    name: ç”Ÿæˆåˆè§„æŠ¥å‘Š
    action: generate_document
    params:
      template: "license-compliance-report.md"
      variables:
        dependency_scan: "{{dependency_scan}}"
        license_analysis: "{{license_analysis}}"
        conflict_check: "{{conflict_check}}"
        date: "{{current_date}}"
      output: "docs/license-compliance-report-{{current_date}}.md"
      save_as: report_file

  - id: 5
    name: è¾“å‡ºæ£€æŸ¥ç»“æœ
    action: notify
    params:
      message: |
        è®¸å¯è¯åˆè§„æ£€æŸ¥å®Œæˆï¼
        
        ä¾èµ–æ‰«æ:
        {{dependency_scan}}
        
        è®¸å¯è¯åˆ†æ:
        {{license_analysis}}
        
        å†²çªæ£€æŸ¥:
        {{conflict_check}}
        
        âš ï¸ å‘ç° 2 ä¸ªGPLè®¸å¯è¯å†²çªï¼
        
        å®Œæ•´æŠ¥å‘Š: {{report_file}}